"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("axios"),t=require("eventsource-parser"),r=require("http"),n=require("https"),a=require("moment-timezone"),s=require("zod");function o(e,t){this.v=e,this.k=t}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function u(e){var t,r,n,a=2;for("undefined"!=typeof Symbol&&(r=Symbol.asyncIterator,n=Symbol.iterator);a--;){if(r&&null!=(t=e[r]))return t.call(e);if(n&&null!=(t=e[n]))return new c(t.call(e));r="@@asyncIterator",n="@@iterator"}throw new TypeError("Object is not async iterable")}function c(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then((function(e){return{value:e,done:t}}))}return c=function(e){this.s=e,this.n=e.next},c.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var r=this.s.return;return void 0===r?Promise.resolve({value:e,done:!0}):t(r.apply(this.s,arguments))},throw:function(e){var r=this.s.return;return void 0===r?Promise.reject(e):t(r.apply(this.s,arguments))}},new c(e)}function l(e,t,r,n,a,s,o){try{var i=e[s](o),u=i.value}catch(e){return void r(e)}i.done?t(u):Promise.resolve(u).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function o(e){l(s,n,a,o,i,"next",e)}function i(e){l(s,n,a,o,i,"throw",e)}o(void 0)}))}}function d(e){return new o(e,0)}function z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return i(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},b.apply(null,arguments)}function f(){f=function(){return t};var e,t={},r=Object.prototype,n=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},o=s.iterator||"@@iterator",i=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function l(e,t,r,n){var s=Object.create((t&&t.prototype instanceof g?t:g).prototype),o=new A(n||[]);return a(s,"_invoke",{value:k(e,r,o)}),s}function p(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var d="suspendedStart",z="suspendedYield",b="executing",m="completed",h={};function g(){}function v(){}function y(){}var x={};c(x,o,(function(){return this}));var _=Object.getPrototypeOf,w=_&&_(_(C([])));w&&w!==r&&n.call(w,o)&&(x=w);var S=y.prototype=g.prototype=Object.create(x);function E(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function I(e,t){function r(a,s,o,i){var u=p(e[a],e,s);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==typeof l&&n.call(l,"__await")?t.resolve(l.__await).then((function(e){r("next",e,o,i)}),(function(e){r("throw",e,o,i)})):t.resolve(l).then((function(e){c.value=e,o(c)}),(function(e){return r("throw",e,o,i)}))}i(u.arg)}var s;a(this,"_invoke",{value:function(e,n){function a(){return new t((function(t,a){r(e,n,t,a)}))}return s=s?s.then(a,a):a()}})}function k(t,r,n){var a=d;return function(s,o){if(a===b)throw Error("Generator is already running");if(a===m){if("throw"===s)throw o;return{value:e,done:!0}}for(n.method=s,n.arg=o;;){var i=n.delegate;if(i){var u=j(i,n);if(u){if(u===h)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===d)throw a=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=b;var c=p(t,r,n);if("normal"===c.type){if(a=n.done?m:z,c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(a=m,n.method="throw",n.arg=c.arg)}}}function j(t,r){var n=r.method,a=t.iterator[n];if(a===e)return r.delegate=null,"throw"===n&&t.iterator.return&&(r.method="return",r.arg=e,j(t,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var s=p(a,t.iterator,r.arg);if("throw"===s.type)return r.method="throw",r.arg=s.arg,r.delegate=null,h;var o=s.arg;return o?o.done?(r[t.resultName]=o.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,h):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function C(t){if(t||""===t){var r=t[o];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,s=function r(){for(;++a<t.length;)if(n.call(t,a))return r.value=t[a],r.done=!1,r;return r.value=e,r.done=!0,r};return s.next=s}}throw new TypeError(typeof t+" is not iterable")}return v.prototype=y,a(S,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:v,configurable:!0}),v.displayName=c(y,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,u,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},E(I.prototype),c(I.prototype,i,(function(){return this})),t.AsyncIterator=I,t.async=function(e,r,n,a,s){void 0===s&&(s=Promise);var o=new I(l(e,r,n,a),s);return t.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},E(S),c(S,u,"Generator"),c(S,o,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=C,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function a(n,a){return i.type="throw",i.arg=t,r.next=n,a&&(r.method="next",r.arg=e),!!a}for(var s=this.tryEntries.length-1;s>=0;--s){var o=this.tryEntries[s],i=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var u=n.call(o,"catchLoc"),c=n.call(o,"finallyLoc");if(u&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(u){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var s=a;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,h):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),R(r),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;R(r)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,r,n){return this.delegate={iterator:C(t),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=e),h}},t}function m(e){return function(){return new h(e.apply(this,arguments))}}function h(e){var t,r;function n(t,r){try{var s=e[t](r),i=s.value,u=i instanceof o;Promise.resolve(u?i.v:i).then((function(r){if(u){var o="return"===t?"return":"next";if(!i.k||r.done)return n(o,r);r=e[o](r).value}a(s.done?"return":"normal",r)}),(function(e){n("throw",e)}))}catch(e){a("throw",e)}}function a(e,a){switch(e){case"return":t.resolve({value:a,done:!0});break;case"throw":t.reject(a);break;default:t.resolve({value:a,done:!1})}(t=t.next)?n(t.key,t.arg):r=null}this._invoke=function(e,a){return new Promise((function(s,o){var i={key:e,arg:a,resolve:s,reject:o,next:null};r?r=r.next=i:(t=r=i,n(e,a))}))},"function"!=typeof e.return&&(this.return=void 0)}h.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},h.prototype.next=function(e){return this._invoke("next",e)},h.prototype.throw=function(e){return this._invoke("throw",e)},h.prototype.return=function(e){return this._invoke("return",e)};var g=function(){return s.z.custom((function(e){return"string"==typeof e}))},v=g(),y=g(),x=g(),_=s.z.object({type:g(),message:s.z.string()}),w=s.z.number(),S={"application/msword":[".doc",".docx"],"application/vnd.openxmlformats-officedocument.wordprocessingml.document":[".doc",".docx"],"application/vnd.ms-powerpoint":[".ppt",".pptx"],"application/vnd.openxmlformats-officedocument.presentationml.presentation":[".ppt",".pptx"],"application/vnd.google-apps.document":[],"application/vnd.google-apps.presentation":[],"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":[".xlsx"],"application/vnd.google-apps.spreadsheet":[],"application/vnd.ms-excel":[".xls"],"application/pdf":[".pdf"],"application/vnd.dust.section.json":[".json"],"text/comma-separated-values":[".csv"],"text/csv":[".csv"],"text/markdown":[".md",".markdown"],"text/plain":[".txt",".log",".cfg",".conf"],"text/tab-separated-values":[".tsv"],"text/tsv":[".tsv"],"text/vnd.dust.attachment.slack.thread":[".txt"],"text/html":[".html",".htm",".xhtml",".xhtml+xml"],"text/xml":[".xml"],"text/calendar":[".ics"],"text/css":[".css"],"text/javascript":[".js",".mjs",".jsx"],"text/typescript":[".ts",".tsx"],"application/json":[".json"],"application/xml":[".xml"],"application/x-sh":[".sh"],"text/x-sh":[".sh"],"text/x-python":[".py"],"text/x-python-script":[".py"],"application/x-yaml":[".yaml",".yml"],"text/yaml":[".yaml",".yml"],"text/vnd.yaml":[".yaml",".yml"],"text/x-c":[".c",".cc",".cpp",".cxx",".dic",".h",".hh"],"text/x-csharp":[".cs"],"text/x-java-source":[".java"],"text/x-php":[".php"],"text/x-ruby":[".rb"],"text/x-sql":[".sql"],"text/x-swift":[".swift"],"text/x-rust":[".rs"],"text/x-go":[".go"],"text/x-kotlin":[".kt",".kts"],"text/x-scala":[".scala"],"text/x-groovy":[".groovy"],"text/x-perl":[".pl",".pm"],"text/x-perl-script":[".pl",".pm"],"application/octet-stream":[]},E={"image/jpeg":[".jpg",".jpeg"],"image/png":[".png"],"image/gif":[".gif"],"image/webp":[".webp"]},I=Object.keys(S),k=Object.keys(E),j=[].concat(Object.keys(S),Object.keys(E)),T=[].concat(I,k),R=g(),A=g(),C=g().or(s.z.null()).or(s.z.undefined()),P=g(),O=function(){function e(e){this.value=void 0,this.value=e}var t=e.prototype;return t.isOk=function(){return!0},t.isErr=function(){return!1},e}(),N=function(){function e(e){this.error=void 0,this.error=e}var t=e.prototype;return t.isOk=function(){return!1},t.isErr=function(){return!0},e}(),F=s.z.string().refine((function(e){return a.tz.names().includes(e)}),{message:"Invalid timezone"}),D=g(),L=s.z.object({editedAt:s.z.number().nullable(),fullName:s.z.string().nullable(),imageUrl:s.z.string().nullable(),email:s.z.string().nullable(),userId:s.z.string().nullable()}),U=s.z.object({id:w,sId:s.z.string(),createdAt:s.z.number(),name:s.z.string(),description:s.z.string().nullable(),assistantDefaultSelected:s.z.boolean(),dustAPIProjectId:s.z.string(),dustAPIDataSourceId:s.z.string(),connectorId:s.z.string().nullable(),connectorProvider:D.nullable(),editedByUser:L.nullable().optional()}),q=g(),M=g(),G=s.z.enum(["running","succeeded","errored"]),B=s.z.record(s.z.any()),W=s.z.object({block_type:M,name:s.z.string(),status:G,success_count:s.z.number(),error_count:s.z.number()}),V=s.z.object({blocks:B}),H=s.z.object({value:s.z.unknown().nullable(),error:s.z.string().nullable(),meta:s.z.unknown().nullable()}),Y=s.z.object({run:G,blocks:s.z.array(W)}),K=s.z.object({run_id:s.z.string(),created:s.z.number(),run_type:s.z.enum(["deploy","local","execute"]),app_hash:s.z.string().nullable().optional(),specification_hash:s.z.string().nullable().optional(),config:V,status:Y,traces:s.z.array(s.z.tuple([s.z.tuple([M,s.z.string()]),s.z.array(s.z.array(H))])),results:s.z.array(s.z.array(s.z.object({value:s.z.unknown().nullable().optional(),error:s.z.string().nullable().optional()}))).nullable().optional()}),Q=g(),J=s.z.object({type:s.z.literal("generation_tokens"),created:s.z.number(),configurationId:s.z.string(),messageId:s.z.string(),text:s.z.string(),classification:s.z.union([Q,s.z.enum(["opening_delimiter","closing_delimiter"])]),delimiterClassification:Q.nullable().optional()}),Z=s.z.object({id:w,type:g()}),$=s.z.object({results:s.z.array(s.z.object({requestedUrl:s.z.string(),browsedUrl:s.z.string(),content:s.z.string(),responseCode:s.z.string(),errorMessage:s.z.string()}))}),X=Z.extend({agentMessageId:w,urls:s.z.array(s.z.string()),output:$.nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("browse_action")}),ee=Z.extend({agentMessageId:w,output:s.z.object({tags:s.z.array(s.z.object({tag:s.z.string(),match_count:s.z.number(),data_sources:s.z.array(s.z.string())}))}).nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("search_labels_action")}),te=Z.extend({agentMessageId:w,output:s.z.string().nullable(),thinking:s.z.string().nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("reasoning_action")}),re=Z.extend({agentMessageId:w,params:s.z.object({fileId:s.z.string()}),tokensCount:s.z.number().nullable(),fileTitle:s.z.string().nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("conversation_include_file_action")}),ne=Z.extend({files:s.z.array(s.z.union([s.z.object({fileId:s.z.string(),contentFragmentId:s.z.undefined(),nodeDataSourceViewId:s.z.undefined(),title:s.z.string(),contentType:R}),s.z.object({fileId:s.z.undefined(),contentFragmentId:s.z.string(),nodeDataSourceViewId:s.z.string(),title:s.z.string(),contentType:R})])),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),agentMessageId:w,step:s.z.number(),type:s.z.literal("conversation_list_files_action")}),ae=s.z.record(s.z.union([s.z.string(),s.z.number(),s.z.boolean()])),se=Z.extend({agentMessageId:w,appWorkspaceId:s.z.string(),appId:s.z.string(),appName:s.z.string(),params:ae,runningBlock:s.z.object({type:s.z.string(),name:s.z.string(),status:s.z.enum(["running","succeeded","errored"])}).nullable(),output:s.z.unknown().nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("dust_app_run_action")}).transform((function(e){return b({},e,{output:e.output})})),oe=g(),ie=s.z.object({category:q,createdAt:s.z.number(),dataSource:U,editedByUser:L.nullable().optional(),id:w,kind:oe,parentsIn:s.z.array(s.z.string()).nullable(),sId:s.z.string(),updatedAt:s.z.number(),spaceId:s.z.string()}),ue=s.z.enum(["hour","day","week","month","year"]),ce=s.z.object({duration:s.z.number(),unit:ue}),le=s.z.object({chunks:s.z.array(s.z.object({offset:s.z.number(),score:s.z.number().nullable(),text:s.z.string()})),documentId:s.z.string(),dataSourceView:ie.nullable(),id:w,reference:s.z.string(),score:s.z.number().nullable(),sourceUrl:s.z.string().nullable(),tags:s.z.array(s.z.string()),timestamp:s.z.number()}),pe=Z.extend({agentMessageId:w,params:s.z.object({relativeTimeFrame:ce.nullable(),query:s.z.string().nullable(),topK:s.z.number()}),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),documents:s.z.array(le).nullable(),step:s.z.number(),type:s.z.literal("retrieval_action")}),de=s.z.union([s.z.custom(),s.z.null()]),ze=s.z.object({data:s.z.array(s.z.unknown()),min_timestamp:s.z.number(),total_documents:s.z.number(),total_chunks:s.z.number(),total_tokens:s.z.number()}),be=Z.extend({agentMessageId:w,params:s.z.object({relativeTimeFrame:ce.nullable()}),jsonSchema:de,outputs:ze.nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("process_action")}),fe=Z.extend({params:ae,output:s.z.record(s.z.union([s.z.string(),s.z.number(),s.z.boolean()])).nullable(),resultsFileId:s.z.string().nullable(),resultsFileSnippet:s.z.string().nullable(),sectionFileId:s.z.string().nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),agentMessageId:w,step:s.z.number(),type:s.z.literal("tables_query_action")}),me=g(),he=g().nullable(),ge=s.z.enum(["admin","builder","user","none"]),ve=s.z.object({id:w,sId:s.z.string(),name:s.z.string(),role:ge,segmentation:he,whiteListedProviders:v.array().nullable(),defaultEmbeddingProvider:x.nullable()}).extend({ssoEnforced:s.z.boolean().optional()}),ye=ve.extend({blacklistedDomains:s.z.array(s.z.string()).nullable()}),xe=g().nullable(),_e=s.z.object({sId:s.z.string(),id:w,createdAt:s.z.number(),provider:xe,username:s.z.string(),email:s.z.string(),firstName:s.z.string(),lastName:s.z.string().nullable(),fullName:s.z.string(),image:s.z.string().nullable()}),we=s.z.object({title:s.z.string(),snippet:s.z.string(),link:s.z.string(),reference:s.z.string()}),Se=s.z.union([s.z.object({results:s.z.array(we)}),s.z.object({results:s.z.array(we),error:s.z.string()})]),Ee=Z.extend({agentMessageId:w,query:s.z.string(),output:Se.nullable(),functionCallId:s.z.string().nullable(),functionCallName:s.z.string().nullable(),step:s.z.number(),type:s.z.literal("websearch_action")}),Ie=Z.extend({agentMessageId:w,functionCallName:s.z.string().nullable(),params:s.z.unknown(),type:s.z.literal("tool_action")}),ke=g(),je=s.z.union([g(),ke]),Te=g(),Re=g(),Ae=s.z.object({messageCount:s.z.number(),conversationCount:s.z.number(),userCount:s.z.number(),timePeriodSec:s.z.number()}),Ce=s.z.array(s.z.string()).readonly(),Pe=s.z.object({providerId:v,modelId:y,temperature:s.z.number()}),Oe=s.z.object({id:w,versionCreatedAt:s.z.string().nullable(),sId:s.z.string(),version:s.z.number(),versionAuthorId:w.nullable(),instructions:s.z.string().nullable(),model:Pe,status:je,scope:Te,userFavorite:s.z.boolean(),name:s.z.string(),description:s.z.string(),pictureUrl:s.z.string(),lastAuthors:Ce.optional(),usage:Ae.optional(),maxStepsPerRun:s.z.number(),visualizationEnabled:s.z.boolean(),templateId:s.z.string().nullable(),groupIds:s.z.array(s.z.string()).optional(),requestedGroupIds:s.z.array(s.z.array(s.z.string()))}),Ne=s.z.object({username:s.z.string().optional().nullable(),fullName:s.z.string().optional().nullable(),email:s.z.string().optional().nullable(),profilePictureUrl:s.z.string().optional().nullable()}),Fe=s.z.union([s.z.literal("document"),s.z.literal("table"),s.z.literal("folder")]),De=s.z.union([s.z.literal("table"),s.z.literal("document"),s.z.literal("all")]),Le=s.z.object({nodeId:s.z.string(),nodeDataSourceViewId:s.z.string(),nodeType:Fe,provider:D.nullable(),spaceName:s.z.string()}),Ue=s.z.object({id:w,sId:s.z.string(),fileId:s.z.string().nullable(),created:s.z.number(),type:s.z.literal("content_fragment"),visibility:P,version:s.z.number(),sourceUrl:s.z.string().nullable(),textUrl:s.z.string(),textBytes:s.z.number().nullable(),title:s.z.string(),contentType:R,context:Ne,contentFragmentId:s.z.string(),contentFragmentVersion:s.z.union([s.z.literal("latest"),s.z.literal("superseded")]),contentNodeData:Le.nullable()}),qe=s.z.object({configurationId:s.z.string()}),Me=s.z.object({username:s.z.string(),timezone:F,fullName:s.z.string().optional().nullable(),email:s.z.string().optional().nullable(),profilePictureUrl:s.z.string().optional().nullable(),origin:C,clientSideMCPServerIds:s.z.array(s.z.string()).optional().nullable()}),Ge=s.z.object({id:w,created:s.z.number(),type:s.z.literal("user_message"),sId:s.z.string(),visibility:P,version:s.z.number(),user:_e.nullable(),mentions:s.z.array(qe),content:s.z.string(),context:Me}),Be=s.z.union([pe,se,fe,be,Ee,X,ne,re,te,ee,Ie]),We=g(),Ve=s.z.object({id:w,agentMessageId:w,created:s.z.number(),type:s.z.literal("agent_message"),sId:s.z.string(),visibility:P,version:s.z.number(),parentMessageId:s.z.string().nullable(),configuration:Oe,status:We,actions:s.z.array(Be),content:s.z.string().nullable(),chainOfThought:s.z.string().nullable(),rawContents:s.z.array(s.z.object({step:s.z.number(),content:s.z.string()})),error:s.z.object({code:s.z.string(),message:s.z.string()}).nullable()}),He=s.z.object({messageId:s.z.string(),agentMessageId:s.z.number(),userId:s.z.number(),thumbDirection:s.z.union([s.z.literal("up"),s.z.literal("down")]),content:s.z.string().nullable(),createdAt:s.z.number(),agentConfigurationId:s.z.string(),agentConfigurationVersion:s.z.number(),isConversationShared:s.z.boolean()}),Ye=g(),Ke=s.z.object({id:w,created:s.z.number(),updated:s.z.number().optional(),owner:ve,sId:s.z.string(),title:s.z.string().nullable(),visibility:Ye,groupIds:s.z.array(s.z.string()).optional(),requestedGroupIds:s.z.array(s.z.array(s.z.string()))}),Qe=Ke.extend({content:s.z.array(s.z.union([s.z.array(Ge),s.z.array(Ve),s.z.array(Ue)]))}),Je=s.z.object({message:s.z.string(),code:s.z.string()}),Ze=s.z.tuple([s.z.number(),s.z.string()]),$e=s.z.object({type:g(),message:s.z.string(),data_source_error:Je.optional(),run_error:Je.optional(),app_error:Je.optional(),connectors_error:_.optional()}),Xe=s.z.object({domain:s.z.string(),domainAutoJoinEnabled:s.z.boolean()}),et=s.z.object({appHash:s.z.string(),appId:s.z.string(),workspaceId:s.z.string()}),tt=s.z.record(s.z.unknown()),rt=s.z.object({type:s.z.literal("error"),content:s.z.object({code:s.z.string(),message:s.z.string()})}),nt=s.z.object({type:s.z.literal("run_status"),content:s.z.object({status:s.z.enum(["running","succeeded","errored"]),run_id:s.z.string()})}),at=s.z.object({type:s.z.literal("block_status"),content:s.z.object({block_type:M,name:s.z.string(),status:G,success_count:s.z.number(),error_count:s.z.number()})}),st=s.z.object({type:s.z.literal("block_execution"),content:s.z.object({block_type:M,block_name:s.z.string(),execution:s.z.array(s.z.array(s.z.object({value:s.z.unknown().nullable(),error:s.z.string().nullable(),meta:s.z.unknown().nullable()})))})}),ot=s.z.object({type:s.z.literal("final")}),it=s.z.object({type:s.z.literal("tokens"),content:s.z.object({block_type:s.z.string(),block_name:s.z.string(),input_index:s.z.number(),map:s.z.object({name:s.z.string(),iteration:s.z.number()}).nullable(),tokens:s.z.object({text:s.z.string(),tokens:s.z.array(s.z.string()).optional(),logprobs:s.z.array(s.z.number()).optional()})})}),ut=s.z.object({type:s.z.literal("function_call"),content:s.z.object({block_type:s.z.string(),block_name:s.z.string(),input_index:s.z.number(),map:s.z.object({name:s.z.string(),iteration:s.z.number()}).nullable(),function_call:s.z.object({name:s.z.string()})})}),ct=s.z.object({type:s.z.literal("function_call_arguments_tokens"),content:s.z.object({block_type:s.z.string(),block_name:s.z.string(),input_index:s.z.number(),map:s.z.object({name:s.z.string(),iteration:s.z.number()}).nullable(),tokens:s.z.object({text:s.z.string()})})}),lt=g(),pt=s.z.object({createdAt:s.z.number(),groupIds:s.z.array(s.z.string()),isRestricted:s.z.boolean(),kind:lt,name:s.z.string(),sId:s.z.string(),updatedAt:s.z.number()}),dt=g(),zt=s.z.object({name:s.z.string(),description:s.z.string().nullable(),data:s.z.array(s.z.record(s.z.any())).nullable().optional(),schema:s.z.array(s.z.object({key:s.z.string(),type:dt,description:s.z.string().nullable()})).nullable().optional()}),bt=s.z.object({id:w,sId:s.z.string(),name:s.z.string(),description:s.z.string().nullable(),savedSpecification:s.z.string().nullable(),savedConfig:s.z.string().nullable(),savedRun:s.z.string().nullable(),dustAPIProjectId:s.z.string(),space:pt,datasets:s.z.array(zt).optional(),coreSpecifications:s.z.record(s.z.string()).optional()}),ft=s.z.object({id:w.optional(),sId:s.z.string(),name:s.z.string(),description:s.z.string().nullable(),savedSpecification:s.z.string().nullable(),savedConfig:s.z.string().nullable(),savedRun:s.z.string().nullable(),dustAPIProjectId:s.z.string(),datasets:s.z.array(zt).optional(),coreSpecifications:s.z.record(s.z.string()).optional()}),mt=s.z.object({run:K}),ht=s.z.object({data_sources:U.array()}),gt=s.z.object({agentConfiguration:Oe}),vt=s.z.object({userFavorite:s.z.boolean().optional()}),yt=s.z.object({agentConfigurations:Oe.array()}),xt=s.z.object({contentFragment:Ue}),_t=s.z.object({conversation:Qe,message:Ge}),wt=s.z.object({feedbacks:s.z.array(He)}),St=s.z.object({thumbDirection:s.z.string(),feedbackContent:s.z.string().nullable().optional(),isConversationShared:s.z.boolean().optional()}),Et=s.z.object({success:s.z.literal(!0)}),It=s.z.object({message:Ge}),kt=s.z.object({conversation:Qe}),jt=s.z.object({tokens:Ze.array()}),Tt=s.z.object({emails:s.z.array(s.z.string())}),Rt=s.z.object({verified_domains:Xe.array()}),At=s.z.object({feature_flags:me.array()}),Ct=s.z.intersection(s.z.object({content:s.z.string().min(1),mentions:s.z.array(s.z.object({configurationId:s.z.string()})),context:Me.extend({clientSideMCPServerIds:s.z.array(s.z.string()).optional().nullable()})}),s.z.object({blocking:s.z.boolean().optional()}).partial()),Pt=s.z.object({content:s.z.string(),mentions:s.z.array(s.z.object({configurationId:s.z.string()}))}),Ot=s.z.object({title:s.z.string(),url:s.z.string().optional().nullable(),content:s.z.string(),contentType:s.z.string(),fileId:s.z.undefined().nullable(),nodeId:s.z.undefined().nullable(),nodeDataSourceViewId:s.z.undefined().nullable(),context:Ne.optional().nullable(),supersededContentFragmentId:s.z.string().optional().nullable()}),Nt=s.z.object({title:s.z.string(),fileId:s.z.string(),url:s.z.string().optional().nullable(),content:s.z.undefined().nullable(),contentType:s.z.undefined().nullable(),nodeId:s.z.undefined().nullable(),nodeDataSourceViewId:s.z.undefined().nullable(),context:Ne.optional().nullable(),supersededContentFragmentId:s.z.string().optional().nullable()}),Ft=s.z.object({title:s.z.string(),nodeId:s.z.string(),nodeDataSourceViewId:s.z.string(),url:s.z.undefined().nullable(),content:s.z.undefined().nullable(),contentType:s.z.undefined().nullable(),fileId:s.z.undefined().nullable(),context:Ne.optional().nullable(),supersededContentFragmentId:s.z.string().optional().nullable()}),Dt=s.z.union([Ot,Nt,Ft]),Lt=s.z.intersection(s.z.object({title:s.z.string().nullable().optional(),visibility:s.z.enum(["unlisted","workspace","deleted","test"]).optional().default("unlisted"),message:s.z.union([s.z.intersection(s.z.object({content:s.z.string().min(1),mentions:s.z.array(s.z.object({configurationId:s.z.string()})),context:Me}),s.z.object({blocking:s.z.boolean().optional()}).partial()),s.z.undefined()]),contentFragment:s.z.union([Ot,Nt,Ft,s.z.undefined()]),contentFragments:s.z.union([s.z.union([Ot,Nt,Ft]).array(),s.z.undefined()])}),s.z.object({blocking:s.z.boolean().optional()}).partial()),Ut=s.z.object({conversation:Qe,message:Ge.optional(),contentFragment:Ue.optional()}),qt=s.z.object({conversations:Ke.array()}),Mt=s.z.object({dataSourceId:s.z.string().optional(),kind:s.z.string().optional(),vaultId:s.z.string().optional(),vaultKind:s.z.string().optional()}),Gt=s.z.object({data_source_views:ie.array()}),Bt=s.z.object({email:s.z.string()}),Wt=s.z.object({apps:bt.array()}),Vt=s.z.object({apps:ft.array()}),Ht=s.z.object({apps:s.z.object({sId:s.z.string(),name:s.z.string(),error:s.z.string().optional()}).array()}),Yt=s.z.object({dataSourceView:ie}),Kt=s.z.union([s.z.object({parentsToAdd:s.z.union([s.z.array(s.z.string()),s.z.undefined()]),parentsToRemove:s.z.array(s.z.string()).optional()}).transform((function(e){return{parentsToAdd:e.parentsToAdd,parentsToRemove:e.parentsToRemove}})),s.z.object({parentsIn:s.z.array(s.z.string())})]),Qt=s.z.object({query:s.z.string(),top_k:s.z.coerce.number(),full_text:s.z.coerce.boolean(),target_document_tokens:s.z.coerce.number().optional(),timestamp_gt:s.z.coerce.number().optional(),timestamp_lt:s.z.coerce.number().optional(),tags_in:s.z.array(s.z.string()).optional(),tags_not:s.z.array(s.z.string()).optional(),parents_in:s.z.array(s.z.string()).optional(),parents_not:s.z.array(s.z.string()).optional()}),Jt=s.z.lazy((function(){return s.z.object({prefix:s.z.string().nullable(),content:s.z.string().nullable(),sections:s.z.array(Jt)})})),Zt=s.z.object({timestamp:s.z.number().nullable().optional(),tags:s.z.array(s.z.string()).nullable().optional(),parent_id:s.z.string().nullable().optional(),parents:s.z.array(s.z.string()).nullable().optional(),source_url:s.z.string().nullable().optional(),upsert_context:s.z.object({sync_type:s.z.union([s.z.enum(["batch","incremental"]),s.z.undefined()])}).transform((function(e){return{sync_type:e.sync_type}})).optional(),text:s.z.string().nullable().optional(),section:Jt.nullable().optional(),light_document_output:s.z.boolean().optional(),async:s.z.boolean().nullable().optional(),mime_type:s.z.string().nullable().optional(),title:s.z.string().nullable().optional()}),$t=s.z.object({rows:s.z.array(s.z.object({row_id:s.z.string(),value:s.z.record(s.z.union([s.z.string(),s.z.number(),s.z.boolean(),s.z.object({type:s.z.literal("datetime"),epoch:s.z.number()})]).nullable())})),truncate:s.z.boolean().optional()}),Xt=s.z.object({parent_id:s.z.string().nullable().optional(),parents:s.z.array(s.z.string())}),er=s.z.object({name:s.z.string(),description:s.z.string(),timestamp:s.z.number().nullable().optional(),tags:s.z.array(s.z.string()).nullable().optional(),parentId:s.z.string().nullable().optional(),parents:s.z.array(s.z.string()).nullable().optional(),truncate:s.z.boolean(),async:s.z.boolean().optional(),title:s.z.string(),mimeType:s.z.string(),sourceUrl:s.z.string().nullable().optional(),tableId:s.z.string(),fileId:s.z.string()}),tr=s.z.object({table_id:s.z.string().optional(),name:s.z.string(),description:s.z.string(),timestamp:s.z.number().nullable().optional(),tags:s.z.array(s.z.string()).nullable().optional(),parent_id:s.z.string().nullable().optional(),parents:s.z.array(s.z.string()).nullable().optional(),remote_database_table_id:s.z.string().nullable().optional(),remote_database_secret_id:s.z.string().nullable().optional(),title:s.z.string(),mime_type:s.z.string().nullable().optional(),source_url:s.z.string().nullable().optional()}),rr=g(),nr=s.z.object({data_source_id:s.z.string(),folder_id:s.z.string(),title:s.z.string(),parents:s.z.array(s.z.string()),timestamp:s.z.number()}),ar=s.z.object({folders:s.z.array(nr),total:s.z.number()}),sr=s.z.object({folder:nr}),or=s.z.object({folder:s.z.object({folder_id:s.z.string()})}),ir=s.z.object({folder:nr,data_source:U}),ur=g(),cr=s.z.object({timestamp:s.z.number(),parents:s.z.array(s.z.string()).nullable().optional(),parent_id:s.z.string().nullable().optional(),title:s.z.string(),mime_type:s.z.string(),source_url:s.z.string().nullable().optional(),provider_visibility:ur.nullable().optional()}),lr=s.z.string().refine((function(e){return/^\d{4}-(0[1-9]|1[0-2])(-([0-2]\d|3[01]))?$/.test(e)}),"YYYY-MM or YYYY-MM-DD"),pr=s.z.union([s.z.object({start:lr,end:s.z.undefined(),mode:s.z.literal("month"),table:rr,format:s.z.enum(["csv","json"]).optional().default("csv")}),s.z.object({start:lr,end:lr,mode:s.z.literal("range"),table:rr,format:s.z.enum(["csv","json"]).optional().default("csv")})]),dr=s.z.object({contentType:A,fileName:s.z.string().max(4096,"File name must be less than 4096 characters"),fileSize:s.z.number(),useCase:s.z.union([s.z.literal("conversation"),s.z.literal("upsert_table")]),useCaseMetadata:s.z.object({conversationId:s.z.string()}).optional()}),zr=g(),br=g(),fr=s.z.object({id:s.z.string(),sId:s.z.string(),contentType:s.z.string(),downloadUrl:s.z.string().optional(),fileName:s.z.string(),fileSize:s.z.number(),status:zr,uploadUrl:s.z.string().optional(),publicUrl:s.z.string().optional(),useCase:br}),mr=fr.extend({uploadUrl:s.z.string()}),hr=s.z.object({file:mr}),gr=s.z.object({file:fr}),vr=s.z.object({user:_e.and(s.z.object({workspaces:ve.array().or(ye.array())}))}),yr=s.z.object({success:s.z.literal(!0)}),xr=s.z.object({messageIds:s.z.array(s.z.string())});function _r(e){return e.dataSourceView?"webcrawler"===e.dataSourceView.dataSource.connectorProvider?"document":e.dataSourceView.dataSource.connectorProvider||"document":"document"}var wr=s.z.object({apps:s.z.array(s.z.object({appId:s.z.string(),appHash:s.z.string()}))}),Sr=s.z.object({apps:s.z.array(s.z.object({appId:s.z.string(),appHash:s.z.string(),deployed:s.z.boolean()}))}),Er=s.z.object({spaces:s.z.array(pt)}),Ir=s.z.object({viewType:De,spaceIds:s.z.array(s.z.string()),includeDataSources:s.z.boolean(),limit:s.z.number()}),kr=s.z.union([s.z.intersection(Ir,s.z.object({query:s.z.string(),nodeIds:s.z.undefined().optional()})),s.z.intersection(Ir,s.z.object({nodeIds:s.z.array(s.z.string()),query:s.z.undefined().optional()}))]),jr=s.z.object({expandable:s.z.boolean(),internalId:s.z.string(),lastUpdatedAt:s.z.number().nullable(),mimeType:s.z.string(),parentInternalId:s.z.string().nullable(),preventSelection:s.z.boolean().optional(),providerVisibility:ur.nullable().optional(),sourceUrl:s.z.string().nullable().optional(),title:s.z.string(),type:Fe}),Tr=s.z.intersection(jr,s.z.object({parentsInternalIds:s.z.array(s.z.string()).optional(),parentTitle:s.z.string().optional().nullable()})),Rr=s.z.intersection(Tr,s.z.object({dataSource:U,dataSourceViews:ie.array()})),Ar=s.z.intersection(Tr,s.z.object({dataSourceView:ie})),Cr=s.z.literal("truncated-query-clauses"),Pr=s.z.object({nodes:Rr.array(),warningCode:Cr.optional().nullable()}),Or=s.z.object({success:s.z.boolean()}),Nr=s.z.object({actionId:s.z.number(),approved:s.z.enum(["approved","rejected","always_approved"])}),Fr=s.z.object({success:s.z.boolean(),expiresAt:s.z.string()}),Dr=s.z.object({success:s.z.boolean(),expiresAt:s.z.string()}),Lr=s.z.object({requestId:s.z.string(),result:s.z.unknown()}),Ur=s.z.object({success:s.z.boolean()});function qr(e){var t=e.provider;return e.resourceTypes.reduce((function(e,r){var n;return b({},e,((n={})[r]="application/vnd.dust."+t.replace("_","")+"."+r.replace("_","-").toLowerCase(),n))}),{})}var Mr="application/vnd.dust.datasource",Gr={GENERIC:{DATA_SOURCE:Mr},CONFLUENCE:qr({provider:"confluence",resourceTypes:["SPACE","PAGE"]}),GITHUB:qr({provider:"github",resourceTypes:["REPOSITORY","CODE_ROOT","CODE_DIRECTORY","CODE_FILE","ISSUES","ISSUE","DISCUSSIONS","DISCUSSION"]}),GOOGLE_DRIVE:qr({provider:"google_drive",resourceTypes:["SHARED_WITH_ME","FOLDER","SPREADSHEET"]}),INTERCOM:qr({provider:"intercom",resourceTypes:["COLLECTION","TEAMS_FOLDER","CONVERSATION","TEAM","ARTICLE","HELP_CENTER"]}),MICROSOFT:qr({provider:"microsoft",resourceTypes:["FOLDER","SPREADSHEET"]}),NOTION:qr({provider:"notion",resourceTypes:["UNKNOWN_FOLDER","SYNCING_FOLDER","DATABASE","PAGE"]}),SLACK:qr({provider:"slack",resourceTypes:["CHANNEL","THREAD","MESSAGES"]}),SNOWFLAKE:qr({provider:"snowflake",resourceTypes:["DATABASE","SCHEMA","TABLE"]}),WEBCRAWLER:qr({provider:"webcrawler",resourceTypes:["FOLDER"]}),ZENDESK:qr({provider:"zendesk",resourceTypes:["BRAND","HELP_CENTER","CATEGORY","ARTICLE","TICKETS","TICKET"]}),BIGQUERY:qr({provider:"bigquery",resourceTypes:["DATABASE","SCHEMA","TABLE"]}),SALESFORCE:qr({provider:"salesforce",resourceTypes:["DATABASE","SCHEMA","TABLE"]}),GONG:qr({provider:"gong",resourceTypes:["TRANSCRIPT","TRANSCRIPT_FOLDER"]})},Br={CONFLUENCE:[Gr.CONFLUENCE.PAGE],GITHUB:[Gr.GITHUB.ISSUE,Gr.GITHUB.DISCUSSION],GOOGLE_DRIVE:[],INTERCOM:[Gr.INTERCOM.CONVERSATION,Gr.INTERCOM.ARTICLE],MICROSOFT:[],NOTION:[Gr.NOTION.PAGE],SLACK:[Gr.SLACK.THREAD,Gr.SLACK.MESSAGES],SNOWFLAKE:[],WEBCRAWLER:[],ZENDESK:[Gr.ZENDESK.TICKET,Gr.ZENDESK.ARTICLE],BIGQUERY:[],SALESFORCE:[],GONG:[]};function Wr(e){var t=e.category;return e.resourceTypes.reduce((function(e,r){var n;return b({},e,((n={})[r]="application/vnd.dust."+t.replace(/_/g,"-").toLowerCase()+"."+r.replace(/_/g,"-").toLowerCase(),n))}),{})}var Vr=b({},Gr,{TOOL_INPUT:Wr({category:"TOOL_INPUT",resourceTypes:["DATA_SOURCE","TABLE","CHILD_AGENT","STRING","NUMBER","BOOLEAN","ENUM","REASONING_MODEL","NULLABLE_TIME_FRAME"]}),TOOL_OUTPUT:Wr({category:"TOOL_OUTPUT",resourceTypes:["BROWSE_RESULT","DATA_SOURCE_SEARCH_QUERY","DATA_SOURCE_SEARCH_RESULT","DATA_SOURCE_INCLUDE_QUERY","DATA_SOURCE_INCLUDE_RESULT","FILE","REASONING_SUCCESS","SQL_QUERY","THINKING","WEBSEARCH_QUERY","WEBSEARCH_RESULT"]})}),Hr=Object.values(Gr).flatMap((function(e){return Object.values(e).map((function(e){return e}))})),Yr=Object.values(Br).flatMap((function(e){return Object.values(e).map((function(e){return e}))})),Kr=function(){var e=p(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t.body){e.next=2;break}return e.abrupt("return",t.body);case 2:return r=t.body,e.abrupt("return",new Promise((function(e,t){var n=[];r.on("data",(function(e){return n.push(Buffer.from(e))})),r.on("end",(function(){return e(Buffer.concat(n).toString("utf-8"))})),r.on("error",t)})));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Qr=e.create({httpAgent:new r.Agent({keepAlive:!1}),httpsAgent:new n.Agent({keepAlive:!1})}),Jr=function(){function r(e,t,r,n){this._url=void 0,this._credentials=void 0,this._logger=void 0,this._urlOverride=void 0,this._url=e.url,this._credentials=t,this._logger=r,this._urlOverride=n}var n=r.prototype;return n.workspaceId=function(){return this._credentials.workspaceId},n.setWorkspaceId=function(e){this._credentials.workspaceId=e},n.apiUrl=function(){return this._urlOverride?this._urlOverride:this._url},n.getApiKey=function(){var e=p(f().mark((function e(){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("function"!=typeof this._credentials.apiKey){e.next=2;break}return e.abrupt("return",this._credentials.apiKey());case 2:return e.abrupt("return",this._credentials.apiKey);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.baseHeaders=function(){var e=p(f().mark((function e(){var t;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getApiKey();case 2:return e.t0=e.sent,e.t1="Bearer "+e.t0,t={Authorization:e.t1},this._credentials.extraHeaders&&Object.assign(t,this._credentials.extraHeaders),e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.me=function(){var e=p(f().mark((function e(){var t,r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getApiKey();case 2:return e.t0=e.sent,e.t1="Bearer "+e.t0,t={"Content-Type":"application/json",Authorization:e.t1},e.next=7,this._fetchWithError(this.apiUrl()+"/api/v1/me",{method:"GET",headers:t});case 7:return r=e.sent,e.next=10,this._resultFromResponse(vr,r);case 10:if(!(n=e.sent).isErr()){e.next=13;break}return e.abrupt("return",n);case 13:return e.abrupt("return",new O(n.value.user));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.request=function(){var e=p(f().mark((function e(t){var r,n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.path=t.path.replace(/^\/+/,""),n=this.apiUrl()+"/api/v1/w/"+(null!=(r=t.overrideWorkspaceId)?r:this.workspaceId())+"/"+t.path,t.query&&(n+="?"+t.query.toString()),e.next=5,this.baseHeaders();case 5:return(a=e.sent)["Content-Type"]="application/json",e.next=9,this._fetchWithError(n,{method:t.method,headers:a,data:t.body?JSON.stringify(t.body):void 0,signal:t.signal});case 9:return e.abrupt("return",e.sent);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.runApp=function(){var e=p(f().mark((function e(t,r,n,a){var s,o,i,u,c,l,p;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=t.workspaceId,o=t.appId,i=t.appHash,u=t.appSpaceId,c=(void 0===a?{useWorkspaceCredentials:!1}:a).useWorkspaceCredentials,e.next=4,this.request({overrideWorkspaceId:s,path:"spaces/"+u+"/apps/"+o+"/runs",query:new URLSearchParams({use_workspace_credentials:c?"true":"false"}),method:"POST",body:{specification_hash:i,config:r,stream:!1,blocking:!0,inputs:n}});case 4:return l=e.sent,e.next=7,this._resultFromResponse(mt,l);case 7:if(!(p=e.sent).isErr()){e.next=10;break}return e.abrupt("return",p);case 10:return e.abrupt("return",new O(p.value.run));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),n.runAppStreamed=function(){var e=p(f().mark((function e(r,n,a,s){var o,i,c,l,z,b,h,g;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return g=function(){return g=p(f().mark((function e(r,n){var a,s,o,i,c,l,p,z;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.ok&&r.body){e.next=2;break}return e.abrupt("return",new N({type:"dust_api_error",message:"Error running streamed app: status_code="+r.status}));case 2:return a=!1,i=new Promise((function(e,t){s=t,o=e})),c=[],l=t.createParser((function(e){if("event"===e.type&&e.data)try{var t,r=JSON.parse(e.data);switch(r.type){case"error":c.push({type:"error",content:{code:r.content.code,message:r.content.message}});break;case"run_status":case"block_status":case"block_execution":c.push({type:r.type,content:r.content});break;case"tokens":c.push({type:"tokens",content:r.content});break;case"function_call":c.push({type:"function_call",content:r.content});break;case"function_call_arguments_tokens":c.push({type:"function_call_arguments_tokens",content:r.content});break;case"final":c.push({type:"final"})}null!=(t=r.content)&&t.run_id&&!a&&(a=!0,o(r.content.run_id))}catch(e){n.error({error:e},"Failed parsing chunk from Dust API")}})),p=r.body,z=function(){var e=m(f().mark((function e(){var t,r,o,i,z,b,m,h,g;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!1,r=!1,e.prev=3,i=u(p);case 5:return e.next=7,d(i.next());case 7:if(!(t=!(z=e.sent).done)){e.next=22;break}b=z.value,l.feed((new TextDecoder).decode(b)),m=0,h=c;case 11:if(!(m<h.length)){e.next=18;break}return g=h[m],e.next=15,g;case 15:m++,e.next=11;break;case 18:c=[];case 19:t=!1,e.next=5;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),r=!0,o=e.t0;case 28:if(e.prev=28,e.prev=29,!t||null==i.return){e.next=33;break}return e.next=33,d(i.return());case 33:if(e.prev=33,!r){e.next=36;break}throw o;case 36:return e.finish(33);case 37:return e.finish(28);case 38:a||setImmediate((function(){n.error({},"No run id received."),s(new Error("No run id received"))})),e.next=46;break;case 41:return e.prev=41,e.t1=e.catch(0),n.error({error:e.t1,errorStr:JSON.stringify(e.t1),errorSource:"processStreamedRunResponse"},"DustAPI error: streaming chunks"),e.next=46,{type:"error",content:{code:"stream_error",message:"Error streaming chunks"}};case 46:case"end":return e.stop()}}),e,null,[[0,41],[3,24,28,38],[29,,33,37]])})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",new O({eventStream:z(),dustRunId:i}));case 9:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)},h=function(e,t){return g.apply(this,arguments)},o=r.workspaceId,i=r.appId,c=r.appHash,l=r.appSpaceId,z=(void 0===s?{useWorkspaceCredentials:!1}:s).useWorkspaceCredentials,e.next=6,this.request({overrideWorkspaceId:o,path:"spaces/"+l+"/apps/"+i+"/runs",query:new URLSearchParams({use_workspace_credentials:z?"true":"false"}),method:"POST",body:{specification_hash:c,config:n,stream:!0,blocking:!1,inputs:a}});case 6:if(!(b=e.sent).isErr()){e.next=9;break}return e.abrupt("return",b);case 9:return e.abrupt("return",h(b.value.response,this._logger));case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),n.getDataSources=function(){var e=p(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"data_sources"});case 2:return t=e.sent,e.next=5,this._resultFromResponse(ht,t);case 5:if(!(r=e.sent).isErr()){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new O(r.value.data_sources));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getAgentConfigurations=function(){var e=p(f().mark((function e(t){var r,n,a,s,o,i,u,c;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=function(){var e=new URLSearchParams;return"string"==typeof r&&e.append("view",r),a.includes("authors")&&e.append("withAuthors","true"),e.toString()},a=void 0===(n=t.includes)?[]:n,o=(r=t.view)||a.length>0?s():null,i=o?"assistant/agent_configurations?"+o:"assistant/agent_configurations",e.next=6,this.request({path:i,method:"GET"});case 6:return u=e.sent,e.next=9,this._resultFromResponse(yt,u);case 9:if(!(c=e.sent).isErr()){e.next=12;break}return e.abrupt("return",c);case 12:return e.abrupt("return",new O(c.value.agentConfigurations));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.postContentFragment=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,n=t.contentFragment,e.next=3,this.request({method:"POST",path:"assistant/conversations/"+r+"/content_fragments",body:b({},n)});case 3:return a=e.sent,e.next=6,this._resultFromResponse(xt,a);case 6:if(!(s=e.sent).isErr()){e.next=9;break}return e.abrupt("return",s);case 9:return e.abrupt("return",new O(s.value.contentFragment));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.createConversation=function(){var e=p(f().mark((function e(t){var r,n,a,s,o,i,u;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.title,n=t.visibility,a=t.message,s=t.contentFragment,o=t.contentFragments,u=void 0!==(i=t.blocking)&&i,e.next=3,this.request({method:"POST",path:"assistant/conversations",body:{title:r,visibility:n,message:a,contentFragment:s,contentFragments:o,blocking:u}});case 3:return e.abrupt("return",this._resultFromResponse(_t,e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.postUserMessage=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,n=t.message,e.next=3,this.request({method:"POST",path:"assistant/conversations/"+r+"/messages",body:b({},n)});case 3:return a=e.sent,e.next=6,this._resultFromResponse(It,a);case 6:if(!(s=e.sent).isErr()){e.next=9;break}return e.abrupt("return",s);case 9:return e.abrupt("return",new O(s.value.message));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.streamAgentAnswerEvents=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.userMessageId,a=t.signal,0!==(s=(r=t.conversation).content.map((function(e){return e[e.length-1]})).filter((function(e){return e&&"agent_message"===e.type&&e.parentMessageId===n}))).length){e.next=4;break}return e.abrupt("return",new N(new Error("Failed to retrieve agent message")));case 4:return e.abrupt("return",this.streamAgentMessageEvents({conversation:r,agentMessage:s[0],signal:a}));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.streamAgentMessageEvents=function(){var e=p(f().mark((function e(r){var n,a,s,o,i,c,l,p,z,b=this;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.conversation,a=r.agentMessage,s=r.signal,e.next=3,this.request({method:"GET",path:"assistant/conversations/"+n.sId+"/messages/"+a.sId+"/events",signal:s});case 3:if(!(o=e.sent).isErr()){e.next=6;break}return e.abrupt("return",o);case 6:if(o.value.response.ok&&o.value.response.body){e.next=15;break}return e.t0=N,e.t1="Error running streamed app: status_code="+o.value.response.status+"  - message=",e.next=11,Kr(o.value.response);case 11:return e.t2=e.sent,e.t3=e.t1+e.t2,e.t4={type:"dust_api_error",message:e.t3},e.abrupt("return",new e.t0(e.t4));case 15:return i=[],c=t.createParser((function(e){if("event"===e.type&&e.data)try{var t=JSON.parse(e.data).data;switch(t.type){case"user_message_error":case"agent_error":case"agent_action_success":case"generation_tokens":case"agent_message_success":case"browse_params":case"dust_app_run_block":case"dust_app_run_params":case"process_params":case"retrieval_params":case"search_labels_params":case"tables_query_output":case"tables_query_params":case"websearch_params":i.push(t)}}catch(e){b._logger.error({error:e},"Failed parsing chunk from Dust API")}})),l=o.value.response.body,p=this._logger,z=function(){var e=m(f().mark((function e(){var t,r,n,a,s,o,z,b,m;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,t=!1,r=!1,e.prev=3,a=u(l);case 5:return e.next=7,d(a.next());case 7:if(!(t=!(s=e.sent).done)){e.next=22;break}o=s.value,c.feed((new TextDecoder).decode(o)),z=0,b=i;case 11:if(!(z<b.length)){e.next=18;break}return m=b[z],e.next=15,m;case 15:z++,e.next=11;break;case 18:i=[];case 19:t=!1,e.next=5;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),r=!0,n=e.t0;case 28:if(e.prev=28,e.prev=29,!t||null==a.return){e.next=33;break}return e.next=33,d(a.return());case 33:if(e.prev=33,!r){e.next=36;break}throw n;case 36:return e.finish(33);case 37:return e.finish(28);case 38:e.next=45;break;case 40:return e.prev=40,e.t1=e.catch(0),p.error({error:e.t1,errorStr:JSON.stringify(e.t1),errorSource:"streamAgentAnswerEvents"},"DustAPI error: streaming chunks"),e.next=45,{type:"error",content:{code:"stream_error",message:"Error streaming chunks"}};case 45:case"end":return e.stop()}}),e,null,[[0,40],[3,24,28,38],[29,,33,37]])})));return function(){return e.apply(this,arguments)}}(),e.abrupt("return",new O({eventStream:z()}));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.cancelMessageGeneration=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,n=t.messageIds,e.next=3,this.request({method:"POST",path:"assistant/conversations/"+r+"/cancel",body:{messageIds:n}});case 3:return a=e.sent,e.next=6,this._resultFromResponse(yr,a);case 6:if(!(s=e.sent).isErr()){e.next=11;break}return e.abrupt("return",s);case 11:return e.abrupt("return",new O(s.value));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getConversations=function(){var e=p(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"assistant/conversations"});case 2:return t=e.sent,e.next=5,this._resultFromResponse(qt,t);case 5:if(!(r=e.sent).isErr()){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new O(r.value.conversations));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getConversation=function(){var e=p(f().mark((function e(t){var r,n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,e.next=3,this.request({method:"GET",path:"assistant/conversations/"+r});case 3:return n=e.sent,e.next=6,this._resultFromResponse(kt,n);case 6:if(!(a=e.sent).isErr()){e.next=9;break}return e.abrupt("return",a);case 9:return e.abrupt("return",new O(a.value.conversation));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getConversationFeedback=function(){var e=p(f().mark((function e(t){var r,n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,e.next=3,this.request({method:"GET",path:"assistant/conversations/"+r+"/feedbacks"});case 3:return n=e.sent,e.next=6,this._resultFromResponse(wt,n);case 6:if(!(a=e.sent).isErr()){e.next=9;break}return e.abrupt("return",a);case 9:return e.abrupt("return",new O(a.value.feedbacks));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.postFeedback=function(){var e=p(f().mark((function e(t,r,n){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"POST",path:"assistant/conversations/"+t+"/messages/"+r+"/feedbacks",body:n});case 2:return e.abrupt("return",this._resultFromResponse(Et,e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),n.deleteFeedback=function(){var e=p(f().mark((function e(t,r){return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"DELETE",path:"assistant/conversations/"+t+"/messages/"+r+"/feedbacks"});case 2:return e.abrupt("return",this._resultFromResponse(Et,e.sent));case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),n.tokenize=function(){var e=p(f().mark((function e(t,r){var n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"POST",path:"data_sources/"+r+"/tokenize",body:{text:t}});case 2:return n=e.sent,e.next=5,this._resultFromResponse(jt,n);case 5:if(!(a=e.sent).isErr()){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new O(a.value.tokens));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),n.upsertFolder=function(){var e=p(f().mark((function e(t){var r,n,a,s,o,i,u,c,l,p,d;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dataSourceId,n=t.folderId,a=t.timestamp,s=t.title,o=t.parentId,i=t.parents,u=t.mimeType,c=t.sourceUrl,l=t.providerVisibility,e.next=3,this.request({method:"POST",path:"data_sources/"+r+"/folders/"+encodeURIComponent(n),body:{timestamp:Math.floor(a),title:s,parent_id:o,parents:i,mime_type:u,source_url:c,provider_visibility:l}});case 3:return p=e.sent,e.next=6,this._resultFromResponse(ir,p);case 6:if(!(d=e.sent).isErr()){e.next=9;break}return e.abrupt("return",d);case 9:return e.abrupt("return",new O(d.value));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.deleteFolder=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dataSourceId,n=t.folderId,e.next=3,this.request({method:"DELETE",path:"data_sources/"+r+"/folders/"+encodeURIComponent(n)});case 3:return a=e.sent,e.next=6,this._resultFromResponse(or,a);case 6:if(!(s=e.sent).isErr()){e.next=9;break}return e.abrupt("return",s);case 9:return e.abrupt("return",new O(s.value));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.uploadFile=function(){var t=p(f().mark((function t(r){var n,a,s,o,i,u,c,l,p,d,z;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.contentType,a=r.fileName,s=r.fileSize,o=r.useCase,i=r.useCaseMetadata,u=r.fileObject,t.next=3,this.request({method:"POST",path:"files",body:{contentType:n,fileName:a,fileSize:s,useCase:o,useCaseMetadata:i}});case 3:return c=t.sent,t.next=6,this._resultFromResponse(hr,c);case 6:if(!(l=t.sent).isErr()){t.next=9;break}return t.abrupt("return",l);case 9:return p=l.value.file,(d=new FormData).append("file",u),t.prev=12,t.t0=Qr,t.t1=p.uploadUrl,t.t2=d,t.next=18,this.baseHeaders();case 18:return t.t3=t.sent,t.t4={headers:t.t3},t.next=22,t.t0.post.call(t.t0,t.t1,t.t2,t.t4);case 22:return t.abrupt("return",new O(t.sent.data.file));case 27:if(t.prev=27,t.t5=t.catch(12),!e.isAxiosError(t.t5)){t.next=31;break}return t.abrupt("return",new N(new Error((null==(z=t.t5.response)||null==(z=z.data)||null==(z=z.error)?void 0:z.message)||"Failed to upload file")));case 31:return t.abrupt("return",new N(new Error(t.t5 instanceof Error?t.t5.message:"Unknown error")));case 32:case"end":return t.stop()}}),t,this,[[12,27]])})));return function(e){return t.apply(this,arguments)}}(),n.deleteFile=function(){var e=p(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.fileID,e.next=3,this.request({method:"DELETE",path:"files/"+r});case 3:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getActiveMemberEmailsInWorkspace=function(){var e=p(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"members/emails",query:new URLSearchParams({activeOnly:"true"})});case 2:return t=e.sent,e.next=5,this._resultFromResponse(Tt,t);case 5:if(!(r=e.sent).isErr()){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new O(r.value.emails));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getWorkspaceVerifiedDomains=function(){var e=p(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"verified_domains"});case 2:return t=e.sent,e.next=5,this._resultFromResponse(Rt,t);case 5:if(!(r=e.sent).isErr()){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new O(r.value.verified_domains));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.getWorkspaceFeatureFlags=function(){var e=p(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"feature_flags"});case 2:return t=e.sent,e.next=5,this._resultFromResponse(At,t);case 5:if(!(r=e.sent).isErr()){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new O(r.value.feature_flags));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.searchDataSourceViews=function(){var e=p(f().mark((function e(t){var r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"data_source_views/search",query:t});case 2:return r=e.sent,e.next=5,this._resultFromResponse(Gt,r);case 5:if(!(n=e.sent).isErr()){e.next=8;break}return e.abrupt("return",n);case 8:return e.abrupt("return",new O(n.value.data_source_views));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.patchDataSourceView=function(){var e=p(f().mark((function e(t,r){var n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"PATCH",path:"spaces/"+t.spaceId+"/data_source_views/"+t.sId,body:r});case 2:return n=e.sent,e.next=5,this._resultFromResponse(Yt,n);case 5:if(!(a=e.sent).isErr()){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new O(a.value.dataSourceView));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),n.exportApps=function(){var e=p(f().mark((function e(t){var r,n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.appSpaceId,e.next=3,this.request({method:"GET",path:"spaces/"+r+"/apps/export"});case 3:return n=e.sent,e.next=6,this._resultFromResponse(Wt,n);case 6:if(!(a=e.sent).isErr()){e.next=9;break}return e.abrupt("return",a);case 9:return e.abrupt("return",new O(a.value.apps));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.checkApps=function(){var e=p(f().mark((function e(t,r){var n,a;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"POST",path:"spaces/"+r+"/apps/check",body:t});case 2:return n=e.sent,e.next=5,this._resultFromResponse(Sr,n);case 5:if(!(a=e.sent).isErr()){e.next=8;break}return e.abrupt("return",a);case 8:return e.abrupt("return",new O(a.value.apps));case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),n.getSpaces=function(){var e=p(f().mark((function e(){var t,r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"GET",path:"spaces"});case 2:return t=e.sent,e.next=5,this._resultFromResponse(Er,t);case 5:if(!(r=e.sent).isErr()){e.next=8;break}return e.abrupt("return",r);case 8:return e.abrupt("return",new O(r.value.spaces));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),n.searchNodes=function(){var e=p(f().mark((function e(t){var r,n;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request({method:"POST",path:"search",body:t});case 2:return r=e.sent,e.next=5,this._resultFromResponse(Pr,r);case 5:if(!(n=e.sent).isErr()){e.next=8;break}return e.abrupt("return",n);case 8:return e.abrupt("return",new O(n.value.nodes));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._fetchWithError=function(){var t=p(f().mark((function t(r,n){var a,s,o,i;return f().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=Date.now(),t.prev=1,t.next=4,Qr(r,b({validateStatus:function(){return!0},responseType:"stream"},n));case 4:return t.abrupt("return",new O({response:{status:(s=t.sent).status,url:s.config.url||r,body:s.data,ok:s.status>=200&&s.status<300},duration:Date.now()-a}));case 9:return t.prev=9,t.t0=t.catch(1),o=Date.now()-a,this._logger.error({dustError:i={type:"unexpected_network_error",message:"Unexpected network error from DustAPI: "+t.t0},url:r,duration:o,connectorsError:i,error:(u=t.t0,e.isAxiosError(u)?b({},u,{config:void 0}):u)},"DustAPI error"),t.abrupt("return",new N(i));case 15:case"end":return t.stop()}var u}),t,this,[[1,9]])})));return function(e,r){return t.apply(this,arguments)}}(),n.validateAction=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.conversationId,n=t.messageId,a=t.actionId,s=t.approved,e.next=3,this.request({method:"POST",path:"assistant/conversations/"+r+"/messages/"+n+"/validate-action",body:{actionId:a,approved:s}});case 3:return e.abrupt("return",this._resultFromResponse(Or,e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.registerMCPServer=function(){var e=p(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.serverId,e.next=3,this.request({method:"POST",path:"mcp/register",body:{serverId:r}});case 3:return e.abrupt("return",this._resultFromResponse(Fr,e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.heartbeatMCPServer=function(){var e=p(f().mark((function e(t){var r;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.serverId,e.next=3,this.request({method:"POST",path:"mcp/heartbeat",body:{serverId:r}});case 3:return e.abrupt("return",this._resultFromResponse(Dr,e.sent));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.postMCPResults=function(){var e=p(f().mark((function e(t){var r,n,a,s;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.requestId,n=t.result,a=t.serverId,(s=new URLSearchParams).set("serverId",a),e.next=5,this.request({method:"POST",path:"mcp/results?"+s.toString(),body:{requestId:r,result:n}});case 5:return e.abrupt("return",this._resultFromResponse(Ur,e.sent));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n.getMCPRequestsConnectionDetails=function(){var e=p(f().mark((function e(t){var r,n,a,s,o;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.serverId,n=t.lastEventId,a=this.apiUrl()+"/api/v1/w/"+this.workspaceId()+"/mcp/requests",s=new URLSearchParams(b({serverId:r},n?{lastEventId:n}:{})),e.next=5,this.baseHeaders();case 5:return o=e.sent,e.abrupt("return",new O({url:a+"?"+s.toString(),headers:o}));case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),n._resultFromResponse=function(){var e=p(f().mark((function e(t,r){var n,a,s,o,i,u,c;return f().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isErr()){e.next=2;break}return e.abrupt("return",r);case 2:if(413!==r.value.response.status){e.next=6;break}return this._logger.error({dustError:n={type:"content_too_large",message:"Your request content is too large, please try again with a shorter content."},status:r.value.response.status,url:r.value.response.url,duration:r.value.duration},"DustAPI error"),e.abrupt("return",new N(n));case 6:return e.next=8,Kr(r.value.response);case 8:if(a=e.sent,e.prev=9,s=JSON.parse(a),!(o=t.safeParse(s)).success){e.next=16;break}return e.abrupt("return",new O(o.data));case 16:if(!(i=$e.safeParse(s.error)).success){e.next=22;break}return this._logger.error({dustError:i.data,status:r.value.response.status,url:r.value.response.url,duration:r.value.duration},"DustAPI error"),e.abrupt("return",new N(i.data));case 22:return this._logger.error({dustError:u={type:"unexpected_response_format",message:"Unexpected response format from DustAPI calling "+r.value.response.url+" : "+o.error.message},parseError:o.error.message,rawText:a,status:r.value.response.status,url:r.value.response.url,duration:r.value.duration},"DustAPI error"),e.abrupt("return",new N(u));case 25:e.next=32;break;case 27:return e.prev=27,e.t0=e.catch(9),this._logger.error({dustError:c={type:"unexpected_response_format",message:"Fail to parse response from DustAPI calling "+r.value.response.url+" : "+e.t0},error:e.t0,rawText:a,status:r.value.response.status,url:r.value.response.url,duration:r.value.duration},"DustAPI error"),e.abrupt("return",new N(c));case 32:case"end":return e.stop()}}),e,this,[[9,27]])})));return function(t,r){return e.apply(this,arguments)}}(),r}();exports.ACTION_RUNNING_LABELS={browse_action:"Browsing page",conversation_include_file_action:"Reading file",conversation_list_files_action:"Listing files",dust_app_run_action:"Running App",process_action:"Extracting data",reasoning_action:"Reasoning",retrieval_action:"Searching data",search_labels_action:"Searching labels",tables_query_action:"Querying tables",websearch_action:"Searching the web",tool_action:"Using a tool"},exports.APIErrorSchema=$e,exports.AgentConfigurationViewSchema=Re,exports.AppsCheckRequestSchema=wr,exports.AppsCheckResponseSchema=Sr,exports.BaseSearchBodySchema=Ir,exports.BrowseActionPublicType=function(e){return"browse_action"===e.type},exports.CONTENT_NODE_MIME_TYPES=Gr,exports.CancelMessageGenerationRequestSchema=xr,exports.CancelMessageGenerationResponseSchema=yr,exports.ContentNodeSchema=jr,exports.ContentNodeTypeSchema=Fe,exports.ContentNodeWithParentSchema=Tr,exports.ContentNodesViewTypeSchema=De,exports.ConversationSchema=Qe,exports.CoreAPIErrorSchema=Je,exports.CoreAPITokenTypeSchema=Ze,exports.CreateConversationResponseSchema=_t,exports.DATA_SOURCE_MIME_TYPE=Mr,exports.DataSourceContentNodeSchema=Rr,exports.DataSourceSearchQuerySchema=Qt,exports.DataSourceViewContentNodeSchema=Ar,exports.DataSourceViewResponseSchema=Yt,exports.DeleteFolderResponseSchema=or,exports.DustAPI=Jr,exports.DustAppConfigTypeSchema=tt,exports.DustAppRunBlockExecutionEventSchema=st,exports.DustAppRunBlockStatusEventSchema=at,exports.DustAppRunErroredEventSchema=rt,exports.DustAppRunFinalEventSchema=ot,exports.DustAppRunFunctionCallArgumentsTokensEventSchema=ct,exports.DustAppRunFunctionCallEventSchema=ut,exports.DustAppRunRunStatusEventSchema=nt,exports.DustAppRunTokensEventSchema=it,exports.DustAppTypeSchema=et,exports.Err=N,exports.FileTypeSchema=fr,exports.FileTypeWithUploadUrlSchema=mr,exports.FileUploadRequestResponseSchema=hr,exports.FileUploadUrlRequestSchema=dr,exports.FileUploadedRequestResponseSchema=gr,exports.GenerationTokensEventSchema=J,exports.GetActiveMemberEmailsInWorkspaceResponseSchema=Tt,exports.GetAgentConfigurationsResponseSchema=yt,exports.GetAppsResponseSchema=Wt,exports.GetConversationResponseSchema=kt,exports.GetConversationsResponseSchema=qt,exports.GetDataSourcesResponseSchema=ht,exports.GetFeedbacksResponseSchema=wt,exports.GetFolderResponseSchema=sr,exports.GetFoldersResponseSchema=ar,exports.GetOrPatchAgentConfigurationResponseSchema=gt,exports.GetSpacesResponseSchema=Er,exports.GetWorkspaceFeatureFlagsResponseSchema=At,exports.GetWorkspaceUsageRequestSchema=pr,exports.GetWorkspaceVerifiedDomainsResponseSchema=Rt,exports.HeartbeatMCPResponseSchema=Dr,exports.INCLUDABLE_INTERNAL_CONTENT_NODE_MIME_TYPES=Br,exports.INCLUDABLE_INTERNAL_MIME_TYPES_VALUES=Yr,exports.INTERNAL_MIME_TYPES=Vr,exports.INTERNAL_MIME_TYPES_VALUES=Hr,exports.ImportAppsResponseSchema=Ht,exports.MeResponseSchema=vr,exports.Ok=O,exports.PatchAgentConfigurationRequestSchema=vt,exports.PatchDataSourceViewRequestSchema=Kt,exports.PostAppsRequestSchema=Vt,exports.PostContentFragmentResponseSchema=xt,exports.PostConversationsResponseSchema=Ut,exports.PostDataSourceDocumentRequestSchema=Zt,exports.PostMCPResultsResponseSchema=Ur,exports.PostMessageFeedbackResponseSchema=Et,exports.PostTableParentsRequestSchema=Xt,exports.PostUserMessageResponseSchema=It,exports.PostWorkspaceSearchResponseBodySchema=Pr,exports.PublicContentFragmentWithContentSchema=Ot,exports.PublicContentFragmentWithFileIdSchema=Nt,exports.PublicPostContentFragmentRequestBodySchema=Dt,exports.PublicPostConversationsRequestBodySchema=Lt,exports.PublicPostEditMessagesRequestBodySchema=Pt,exports.PublicPostMCPResultsRequestBodySchema=Lr,exports.PublicPostMessageFeedbackRequestBodySchema=St,exports.PublicPostMessagesRequestBodySchema=Ct,exports.RegisterMCPResponseSchema=Fr,exports.RetrievalDocumentTypeSchema=le,exports.RunAppResponseSchema=mt,exports.SearchDataSourceViewsRequestSchema=Mt,exports.SearchDataSourceViewsResponseSchema=Gt,exports.SearchRequestBodySchema=kr,exports.SearchWarningCodeSchema=Cr,exports.TokenizeResponseSchema=jt,exports.UpsertDataSourceFolderRequestSchema=cr,exports.UpsertDatabaseTableRequestSchema=tr,exports.UpsertFolderResponseSchema=ir,exports.UpsertTableFromCsvRequestSchema=er,exports.UpsertTableRowsRequestSchema=$t,exports.ValidateActionRequestBodySchema=Nr,exports.ValidateActionResponseSchema=Or,exports.ValidateMemberRequestSchema=Bt,exports.WebsearchResultSchema=we,exports.WorkspaceDomainSchema=Xe,exports.assertNever=function(e){throw new Error(("object"==typeof e?JSON.stringify(e):e)+" is not of type never. This should never happen.")},exports.getProviderFromRetrievedDocument=_r,exports.getTitleFromRetrievedDocument=function(e){if("slack"===_r(e))for(var t,r=z(e.tags);!(t=r()).done;){var n=t.value;if(n.startsWith("channelName:"))return"#"+n.substring(12)}for(var a,s=z(e.tags);!(a=s()).done;){var o=a.value;if(o.startsWith("title:"))return o.substring(6)}return e.documentId},exports.isAgentMention=function(e){return void 0!==e.configurationId},exports.isConnectorProvider=function(e){return D.safeParse(e).success},exports.isConnectorsAPIError=function(e){return"object"==typeof e&&null!==e&&"message"in e&&"string"==typeof e.message&&"type"in e&&"string"==typeof e.type&&_.safeParse(e).success},exports.isDustAppRunActionType=function(e){return"dust_app_run_action"===e.type},exports.isDustMimeType=function(e){return Hr.includes(e)},exports.isFolder=function(e){return!e.connectorProvider},exports.isIncludableInternalMimeType=function(e){return Yr.includes(e)},exports.isProcessActionType=function(e){return"process_action"===e.type},exports.isReasoningActionType=function(e){return"reasoning_action"===e.type},exports.isRetrievalActionType=function(e){return"retrieval_action"===e.type},exports.isSearchLabelsActionType=function(e){return"search_labels_action"===e.type},exports.isSupportedFileContentType=function(e){return T.includes(e)},exports.isSupportedImageContentType=function(e){return k.includes(e)},exports.isSupportedPlainTextContentType=function(e){return I.includes(e)},exports.isTablesQueryActionType=function(e){return"tables_query_action"===e.type},exports.isWebsearchActionType=function(e){return"websearch_action"===e.type},exports.isWebsite=function(e){return"webcrawler"===e.connectorProvider},exports.removeNulls=function(e){return e.filter((function(e){return null!=e}))},exports.supportedFileExtensions=j,exports.supportedImageFileFormats=E,exports.supportedOtherFileFormats=S;
//# sourceMappingURL=client.cjs.production.min.js.map
